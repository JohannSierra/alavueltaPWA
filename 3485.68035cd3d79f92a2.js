"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3485],{3485:(G,f,i)=>{i.r(f),i.d(f,{LoginPageModule:()=>I});var h=i(2881),g=i(4341),t=i(3092),p=i(5207),d=i(467),e=i(1360),C=i(5032),M=i(5844);function F(r,s){1&r&&(e.qex(0),e.EFF(1,"Entrar"),e.bVm())}function y(r,s){1&r&&(e.qex(0),e.nrm(1,"ion-spinner",11),e.EFF(2," Cargando... "),e.bVm())}const L=[{path:"",component:(()=>{var r;class s{constructor(n,o,l){this.navCtrl=n,this.authService=o,this.alertCtrl=l,this.correo="",this.contrasena="",this.recordarme=!1,this.mostrarPassword=!1,this.cargando=!1}ngOnInit(){requestIdleCallback(()=>{const n=localStorage.getItem("correo");n&&(this.correo=n,this.recordarme=!0)})}goToRegister(){this.navCtrl.navigateForward("/register")}mostrarAlerta(n,o){var l=this;return(0,d.A)(function*(){yield(yield l.alertCtrl.create({header:n,message:o,buttons:["OK"]})).present()})()}verificar(){var n=this;return(0,d.A)(function*(){if(!n.correo.trim()||!n.contrasena.trim())return n.mostrarAlerta("Campos incompletos","Ingresa tu correo y contrase\xf1a.");n.cargando=!0;try{const{getAuth:o}=yield Promise.resolve().then(i.bind(i,9579)),P=(o(),(yield n.authService.login(n.correo,n.contrasena)).user);requestIdleCallback(()=>{n.recordarme?localStorage.setItem("correo",n.correo):localStorage.removeItem("correo")});const b=P.getIdToken(),R=n.authService.fetchUserProfile().catch(function(){var E=(0,d.A)(function*(m){if(404===m.status){const v={nombre:P.displayName||"Nuevo usuario",telefono:"",direccion:"",vendedor:!1};return yield n.authService.registerUser(v),v}throw m});return function(m){return E.apply(this,arguments)}}()),[T,u]=yield Promise.all([b,R]);n.authService.setToken(T),n.navCtrl.navigateForward(null!=u&&u.vendedor?"/inventario":"/hub")}catch(o){console.error("Error al iniciar sesi\xf3n:",o),n.mostrarAlerta("Error de inicio de sesi\xf3n",o.message||"Verifica tus credenciales.")}finally{n.cargando=!1}})()}goToHome(){this.navCtrl.navigateForward("/home")}}return(r=s).\u0275fac=function(n){return new(n||r)(e.rXU(C.q9),e.rXU(M.u),e.rXU(t.hG))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-login"]],standalone:!1,decls:24,vars:8,consts:[[1,"ion-padding"],["position","floating"],["type","email","required","",3,"ngModelChange","ngModel"],["required","",3,"ngModelChange","ngModel","type"],["slot","end",1,"icon-password-toggle",2,"cursor","pointer",3,"click","name"],["lines","none"],["slot","start",3,"ngModelChange","ngModel"],["expand","block",1,"btn",3,"click","disabled"],[4,"ngIf"],[1,"ion-text-center",2,"margin-top","2rem"],["fill","clear",3,"click"],["name","crescent","slot","start"]],template:function(n,o){1&n&&(e.j41(0,"ion-content",0)(1,"fieldset")(2,"legend"),e.EFF(3,"Iniciar sesi\xf3n"),e.k0s(),e.j41(4,"ion-item")(5,"ion-label",1),e.EFF(6,"Correo"),e.k0s(),e.j41(7,"ion-input",2),e.mxI("ngModelChange",function(a){return e.DH7(o.correo,a)||(o.correo=a),a}),e.k0s()(),e.j41(8,"ion-item")(9,"ion-label",1),e.EFF(10,"Contrase\xf1a"),e.k0s(),e.j41(11,"ion-input",3),e.mxI("ngModelChange",function(a){return e.DH7(o.contrasena,a)||(o.contrasena=a),a}),e.k0s(),e.j41(12,"ion-icon",4),e.bIt("click",function(){return o.mostrarPassword=!o.mostrarPassword}),e.k0s()(),e.j41(13,"ion-item",5)(14,"ion-checkbox",6),e.mxI("ngModelChange",function(a){return e.DH7(o.recordarme,a)||(o.recordarme=a),a}),e.k0s(),e.j41(15,"ion-label"),e.EFF(16,"Recordarme"),e.k0s()()(),e.j41(17,"ion-button",7),e.bIt("click",function(){return o.verificar()}),e.DNE(18,F,2,0,"ng-container",8)(19,y,3,0,"ng-container",8),e.k0s(),e.j41(20,"ion-footer",9),e.EFF(21," \xbfNo tienes cuenta? "),e.j41(22,"ion-button",10),e.bIt("click",function(){return o.goToRegister()}),e.EFF(23,"Registrarse"),e.k0s()()()),2&n&&(e.R7$(7),e.R50("ngModel",o.correo),e.R7$(4),e.R50("ngModel",o.contrasena),e.Y8G("type",o.mostrarPassword?"text":"password"),e.R7$(),e.Y8G("name",o.mostrarPassword?"eye-off":"eye"),e.R7$(2),e.R50("ngModel",o.recordarme),e.R7$(3),e.Y8G("disabled",o.cargando),e.R7$(),e.Y8G("ngIf",!o.cargando),e.R7$(),e.Y8G("ngIf",o.cargando))},dependencies:[h.bT,g.BC,g.YS,g.vS,t.Jm,t.eY,t.W9,t.M0,t.iq,t.$w,t.uz,t.he,t.w2,t.hB,t.Gw],styles:[".ion-text-center[_ngcontent-%COMP%]{text-align:center}.btn[_ngcontent-%COMP%]{margin:20px;align-items:center}"]}),s})()}];let k=(()=>{var r;class s{}return(r=s).\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[p.iI.forChild(L),p.iI]}),s})(),I=(()=>{var r;class s{}return(r=s).\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[h.MD,g.YN,t.bv,k]}),s})()}}]);