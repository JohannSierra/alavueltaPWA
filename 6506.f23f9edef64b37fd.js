"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6506],{6506:($,k,g)=>{g.r(k),g.d(k,{AgregarPageModule:()=>U});var f=g(2881),h=g(4341),c=g(3092),j=g(5207),p=g(467),v=g(7643),b=g(5312),F=g(9579),e=g(1360),P=g(5032),A=g(669);const x=["video"],I=["canvas"],M=["inputImagenEncontrado"],C=["inputImagenManual"],G=["inputGaleria"];function R(a,l){if(1&a){const t=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar",12)(2,"ion-title"),e.EFF(3,"Escanear C\xf3digo"),e.k0s(),e.j41(4,"ion-buttons",13)(5,"ion-button",14),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cerrarScannerPWA())}),e.nrm(6,"ion-icon",15),e.k0s()()()(),e.j41(7,"ion-content",16)(8,"div",17),e.nrm(9,"video",18,0)(11,"div",19),e.k0s(),e.nrm(12,"canvas",20,1),e.j41(14,"ion-button",21),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cerrarScannerPWA())}),e.EFF(15," Detener "),e.k0s()()}}function y(a,l){1&a&&(e.j41(0,"ion-text",35)(1,"p",36)(2,"strong"),e.EFF(3,"Producto no encontrado"),e.k0s()()())}function N(a,l){if(1&a&&(e.j41(0,"div",37)(1,"p")(2,"strong"),e.EFF(3,"C\xf3digo:"),e.k0s(),e.EFF(4),e.k0s()()),2&a){const t=e.XpG(2);e.R7$(4),e.SpI(" ",t.codigoEscaneado,"")}}function B(a,l){if(1&a){const t=e.RV6();e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Buscar por c\xf3digo"),e.k0s(),e.j41(4,"ion-card-subtitle"),e.EFF(5,"Escanea o escribe manualmente"),e.k0s()(),e.j41(6,"ion-card-content")(7,"ion-button",22),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.abrirScannerPWA())}),e.nrm(8,"ion-icon",23),e.EFF(9," Escanear con c\xe1mara "),e.k0s(),e.j41(10,"ion-button",24),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.abrirInputGaleria())}),e.nrm(11,"ion-icon",25),e.EFF(12," Importar desde galer\xeda "),e.k0s(),e.j41(13,"input",26,2),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.leerCodigoConImagen(n))}),e.k0s(),e.j41(15,"div",27)(16,"span"),e.EFF(17,"O ingresa manualmente"),e.k0s()(),e.j41(18,"ion-item")(19,"ion-input",28),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.codigoEscaneado,n)||(r.codigoEscaneado=n),e.Njj(n)}),e.k0s(),e.j41(20,"ion-button",29),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.codigoEscaneado="")}),e.nrm(21,"ion-icon",30),e.k0s()(),e.j41(22,"ion-button",31),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.buscarProductoCodigo())}),e.EFF(23," Buscar "),e.k0s(),e.j41(24,"ion-button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.mostrarIngresoManual=!0)}),e.EFF(25," Ingresar todo manualmente "),e.k0s(),e.DNE(26,y,4,0,"ion-text",33)(27,N,5,1,"div",34),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(19),e.R50("ngModel",t.codigoEscaneado),e.R7$(3),e.Y8G("disabled",!t.codigoEscaneado||t.codigoEscaneado.length<8),e.R7$(4),e.Y8G("ngIf",t.productoNoEncontrado),e.R7$(),e.Y8G("ngIf",t.codigoEscaneado)}}function T(a,l){if(1&a){const t=e.RV6();e.j41(0,"div",44),e.nrm(1,"img",45),e.j41(2,"ion-button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.eliminarImagen())}),e.nrm(3,"ion-icon",30),e.EFF(4," Quitar "),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(),e.Y8G("src",t.imagenURL,e.B4B)}}function O(a,l){if(1&a){const t=e.RV6();e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Producto encontrado"),e.k0s()(),e.j41(4,"ion-card-content")(5,"ion-item")(6,"ion-label")(7,"strong"),e.EFF(8,"Nombre:"),e.k0s(),e.EFF(9),e.k0s()(),e.j41(10,"ion-item")(11,"ion-label",38),e.EFF(12,"Precio"),e.k0s(),e.j41(13,"ion-input",39),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.precio,n)||(r.precio=n),e.Njj(n)}),e.k0s()(),e.j41(14,"ion-item")(15,"ion-label",38),e.EFF(16,"Cantidad"),e.k0s(),e.j41(17,"ion-input",39),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.cantidad,n)||(r.cantidad=n),e.Njj(n)}),e.k0s()(),e.j41(18,"ion-item")(19,"ion-label"),e.EFF(20,"Imagen"),e.k0s(),e.j41(21,"ion-button",40),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.seleccionarImagen())}),e.nrm(22,"ion-icon",41),e.EFF(23," Subir imagen "),e.k0s(),e.j41(24,"input",26,3),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.cargarImagen(n))}),e.k0s()(),e.DNE(26,T,5,1,"div",42),e.j41(27,"ion-button",43),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.agregar())}),e.EFF(28," Agregar "),e.k0s(),e.j41(29,"ion-button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetBusqueda())}),e.EFF(30," Nueva b\xfasqueda "),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(9),e.SpI(" ",t.nombre,""),e.R7$(4),e.R50("ngModel",t.precio),e.R7$(4),e.R50("ngModel",t.cantidad),e.R7$(9),e.Y8G("ngIf",t.imagenURL)}}function V(a,l){if(1&a){const t=e.RV6();e.j41(0,"ion-item",51),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.seleccionarCategoria(n))}),e.EFF(1),e.k0s()}if(2&a){const t=l.$implicit;e.R7$(),e.SpI(" ",t," ")}}function w(a,l){if(1&a&&(e.j41(0,"ion-list"),e.DNE(1,V,2,1,"ion-item",50),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.categoriasFiltradas)}}function X(a,l){if(1&a){const t=e.RV6();e.j41(0,"div",44),e.nrm(1,"img",45),e.j41(2,"ion-button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.eliminarImagen())}),e.nrm(3,"ion-icon",30),e.EFF(4," Quitar "),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(),e.Y8G("src",t.imagenURL,e.B4B)}}function D(a,l){if(1&a){const t=e.RV6();e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Agregar manual"),e.k0s()(),e.j41(4,"ion-card-content")(5,"ion-item")(6,"ion-label",38),e.EFF(7,"C\xf3digo"),e.k0s(),e.j41(8,"ion-input",47),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.codigoEscaneado,n)||(r.codigoEscaneado=n),e.Njj(n)}),e.k0s()(),e.j41(9,"ion-item")(10,"ion-label",38),e.EFF(11,"Nombre"),e.k0s(),e.j41(12,"ion-input",48),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.nombre,n)||(r.nombre=n),e.Njj(n)}),e.k0s()(),e.j41(13,"ion-item")(14,"ion-label",38),e.EFF(15,"Precio"),e.k0s(),e.j41(16,"ion-input",39),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.precio,n)||(r.precio=n),e.Njj(n)}),e.k0s()(),e.j41(17,"ion-item")(18,"ion-label",38),e.EFF(19,"Cantidad"),e.k0s(),e.j41(20,"ion-input",39),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.cantidad,n)||(r.cantidad=n),e.Njj(n)}),e.k0s()(),e.j41(21,"ion-item")(22,"ion-label",38),e.EFF(23,"Categor\xeda"),e.k0s(),e.j41(24,"ion-input",49),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.categoria,n)||(r.categoria=n),e.Njj(n)}),e.bIt("ionInput",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.filtrarCategorias(n))}),e.k0s()(),e.DNE(25,w,2,1,"ion-list",9),e.j41(26,"ion-item")(27,"ion-label"),e.EFF(28,"Imagen"),e.k0s(),e.j41(29,"ion-button",40),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.seleccionarImagen())}),e.nrm(30,"ion-icon",41),e.EFF(31," Subir "),e.k0s(),e.j41(32,"input",26,4),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.cargarImagen(n))}),e.k0s()(),e.DNE(34,X,5,1,"div",42),e.j41(35,"ion-button",43),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.agregar())}),e.EFF(36," Agregar "),e.k0s(),e.j41(37,"ion-button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.mostrarIngresoManual=!1)}),e.EFF(38," Volver "),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(8),e.R50("ngModel",t.codigoEscaneado),e.R7$(4),e.R50("ngModel",t.nombre),e.R7$(4),e.R50("ngModel",t.precio),e.R7$(4),e.R50("ngModel",t.cantidad),e.R7$(4),e.R50("ngModel",t.categoria),e.R7$(),e.Y8G("ngIf",t.categoriasFiltradas.length>0&&t.categoria),e.R7$(9),e.Y8G("ngIf",t.imagenURL)}}const S=[{path:"",component:(()=>{var a;class l{constructor(o,n,r,i){this.navCtrl=o,this.http=n,this.alertCtrl=r,this.barcodeScanner=i,this.codigoEscaneado="",this.nombre="",this.precio=0,this.cantidad=0,this.categoria="",this.productoEncontrado=!1,this.productoNoEncontrado=!1,this.mostrarIngresoManual=!1,this.imagenURL=null,this.imagenFile=null,this.categorias=["General","Frutas","Verduras","L\xe1cteos","Carnes","Bebidas","Snacks","Limpieza","Otros"],this.categoriasFiltradas=[],this.scannerAbierto=!1,this.escaneando=!1}ngOnInit(){console.log("AgregarPage init")}ngOnDestroy(){this.detenerScanner()}abrirScannerPWA(){this.scannerAbierto=!0}iniciarScannerCuandoModalEsteListo(){var o=this;return(0,p.A)(function*(){var n;console.log("Modal presentado, esperando para iniciar esc\xe1ner..."),yield o.delay(500);const r=null===(n=o.video)||void 0===n?void 0:n.nativeElement;if(!r)return console.error("\u274c Elemento video no encontrado despu\xe9s del delay"),yield o.mostrarAlerta("Error","No se pudo acceder al visor de c\xe1mara"),void(o.scannerAbierto=!1);console.log("\u2705 Video element encontrado:",{width:r.videoWidth,height:r.videoHeight,readyState:r.readyState,srcObject:r.srcObject});try{o.escaneando=!0;const i=yield o.barcodeScanner.iniciarScanner(r);o.escaneando=!1,o.scannerAbierto=!1,i?(o.codigoEscaneado=i,yield o.mostrarAlerta("C\xf3digo detectado",i),o.buscarProductoCodigo()):yield o.mostrarAlerta("Sin resultados","No se detect\xf3 ning\xfan c\xf3digo.")}catch(i){o.scannerAbierto=!1,o.escaneando=!1,console.error("Error en scanner:",i),yield o.mostrarAlerta("Error",i.message||"No se pudo iniciar el esc\xe1ner.")}finally{o.detenerScanner()}})()}cerrarScannerPWA(){this.scannerAbierto=!1,this.detenerScanner()}detenerScanner(){try{this.barcodeScanner.detenerScanner()}catch(o){console.error("Error al detener scanner:",o)}}delay(o){return new Promise(n=>setTimeout(n,o))}abrirInputGaleria(){var o;null===(o=this.inputGaleria)||void 0===o||o.nativeElement.click()}leerCodigoConImagen(o){var n=this;return(0,p.A)(function*(){var r,i;const d=o.target;if(null===(r=d.files)||void 0===r||!r.length)return;const u=d.files[0];if(d.value="",!u.type.startsWith("image/"))return n.mostrarAlerta("Error","Selecciona una imagen v\xe1lida.");if(null===(i=n.canvasRef)||void 0===i||!i.nativeElement)return n.mostrarAlerta("Error","Canvas no disponible");try{const s=yield n.cargarImagenHTML(u),_=n.canvasRef.nativeElement;_.width=s.width,_.height=s.height;const m=_.getContext("2d");if(!m)throw new Error("No se pudo obtener contexto 2D del canvas");m.drawImage(s,0,0);const E=yield n.detectarCodigoCanvas(_);E?(n.codigoEscaneado=E,yield n.mostrarAlerta("C\xf3digo detectado",E),n.buscarProductoCodigo()):yield n.mostrarAlerta("No detectado","No se pudo leer ning\xfan c\xf3digo en la imagen.")}catch(s){console.error("Error al leer imagen:",s),yield n.mostrarAlerta("Error",s.message||"Error leyendo la imagen")}})()}cargarImagenHTML(o){return new Promise((n,r)=>{const i=URL.createObjectURL(o),d=new Image;d.onload=()=>{URL.revokeObjectURL(i),n(d)},d.onerror=()=>{URL.revokeObjectURL(i),r(new Error("No se pudo cargar la imagen"))},d.src=i})}detectarCodigoCanvas(o){var n=this;return(0,p.A)(function*(){if("BarcodeDetector"in window)try{const i=yield new BarcodeDetector({formats:["ean_13","ean_8","code_128","qr_code","upc_a","upc_e"]}).detect(o);if(i.length>0)return i[0].rawValue}catch{console.log("BarcodeDetector no disponible, usando ZXing")}return n.barcodeScanner.leerImagen(o)})()}buscarProductoCodigo(){this.codigoEscaneado&&(this.productoNoEncontrado=!1,this.productoEncontrado=!1,this.http.get(`${b.c.apiUrl}/api/productos/${this.codigoEscaneado}`).subscribe({next:o=>{this.nombre=o.nombre,this.precio=o.precioPromedio||o.precio||0,this.categoria=o.categoria||"",this.imagenURL=o.imagenUrl||null,this.productoEncontrado=!0,this.productoNoEncontrado=!1},error:o=>{console.log("Producto no encontrado en BD local, buscando en OpenFoodFacts..."),404===o.status?this.buscarEnOFF():this.productoNoEncontrado=!0}}))}buscarEnOFF(){var o=this;return(0,p.A)(function*(){try{const i=yield(yield fetch(`https://world.openfoodfacts.org/api/v0/product/${o.codigoEscaneado}.json`)).json();if(1===i.status){var n;const d=i.product;o.nombre=d.product_name||"",o.categoria=(null===(n=d.categories)||void 0===n?void 0:n.split(",")[0])||"",o.imagenURL=d.image_url||null,o.productoEncontrado=!0,o.productoNoEncontrado=!1}else o.productoEncontrado=!1,o.productoNoEncontrado=!0}catch(r){console.error("Error buscando en OpenFoodFacts:",r),o.productoNoEncontrado=!0}})()}mostrarAlerta(o,n){var r=this;return(0,p.A)(function*(){yield(yield r.alertCtrl.create({header:o,message:n,buttons:["OK"]})).present()})()}volver(){this.navCtrl.navigateBack("/inventario")}seleccionarImagen(){var o;if(this.productoEncontrado)null===(o=this.inputImagenEncontrado)||void 0===o||o.nativeElement.click();else if(this.mostrarIngresoManual){var n;null===(n=this.inputImagenManual)||void 0===n||n.nativeElement.click()}}cargarImagen(o){const n=o.target;if(!n.files||0===n.files.length)return;const r=n.files[0];if(r.size>5242880)return void this.mostrarAlerta("Error","La imagen no debe exceder 5MB");if(!r.type.match(/image\/(jpeg|png|jpg|webp)/))return void this.mostrarAlerta("Error","Solo se aceptan im\xe1genes JPEG, PNG o WEBP");this.imagenFile=r;const i=new FileReader;i.onload=()=>{this.imagenURL=i.result},i.readAsDataURL(r)}eliminarImagen(){this.imagenURL=null,this.imagenFile=null,this.inputImagenEncontrado&&(this.inputImagenEncontrado.nativeElement.value=""),this.inputImagenManual&&(this.inputImagenManual.nativeElement.value="")}filtrarCategorias(o){const n=o.target.value.toLowerCase();this.categoriasFiltradas=n?this.categorias.filter(r=>r.toLowerCase().includes(n)):[]}seleccionarCategoria(o){this.categoria=o,this.categoriasFiltradas=[]}resetBusqueda(){this.codigoEscaneado="",this.nombre="",this.precio=0,this.cantidad=0,this.categoria="",this.imagenURL=null,this.imagenFile=null,this.productoEncontrado=!1,this.productoNoEncontrado=!1,this.mostrarIngresoManual=!1}agregar(){var o=this;return(0,p.A)(function*(){const r=(0,F.getAuth)().currentUser;if(!r)return void o.mostrarAlerta("Sesi\xf3n requerida","Debes iniciar sesi\xf3n para agregar productos");if(!o.nombre.trim())return void o.mostrarAlerta("Error","Escribe el nombre del producto.");if(o.precio<=0)return void o.mostrarAlerta("Error","El precio debe ser mayor a 0.");if(o.cantidad<0)return void o.mostrarAlerta("Error","La cantidad no puede ser negativa.");const i=o.codigoEscaneado||`TEMP_${Date.now()}`;try{const u=yield r.getIdToken(),s=new FormData;s.append("codigo",i),s.append("nombre",o.nombre.trim()),s.append("precio",o.precio.toString()),s.append("cantidad",o.cantidad.toString()),s.append("categoria",o.categoria||"General"),s.append("descripcion",""),s.append("infoExtra",""),o.imagenFile&&s.append("imagen",o.imagenFile);const _=new v.Lr({Authorization:`Bearer ${u}`});console.log("Enviando producto a inventario..."),yield o.http.post(`${b.c.apiUrl}/api/inventario`,s,{headers:_}).toPromise();try{yield o.http.post(`${b.c.apiUrl}/api/productos`,{codigo:i,nombre:o.nombre.trim(),precioPromedio:o.precio,categoria:o.categoria||"General"},{headers:_}).toPromise()}catch(m){409!==m.status&&console.warn("Error guardando en productos globales:",m)}yield o.mostrarAlerta("\xc9xito","Producto agregado correctamente"),o.resetBusqueda()}catch(u){var d;console.error("Error al agregar producto:",u);let s="Error al agregar el producto. Intente nuevamente.";null!==(d=u.error)&&void 0!==d&&d.mensaje?s=u.error.mensaje:413===u.status?s="La imagen es demasiado grande (m\xe1ximo 5MB)":415===u.status&&(s="Formato de imagen no soportado"),yield o.mostrarAlerta("Error",s)}})()}convertirImagenBase64(o){return new Promise((n,r)=>{const i=new FileReader;i.onload=()=>n(i.result),i.onerror=()=>r(new Error("Error leyendo archivo")),i.readAsDataURL(o)})}}return(a=l).\u0275fac=function(o){return new(o||a)(e.rXU(P.q9),e.rXU(v.Qq),e.rXU(c.hG),e.rXU(A.E))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-agregar"]],viewQuery:function(o,n){if(1&o&&(e.GBs(x,5),e.GBs(I,5),e.GBs(M,5),e.GBs(C,5),e.GBs(G,5)),2&o){let r;e.mGM(r=e.lsd())&&(n.video=r.first),e.mGM(r=e.lsd())&&(n.canvasRef=r.first),e.mGM(r=e.lsd())&&(n.inputImagenEncontrado=r.first),e.mGM(r=e.lsd())&&(n.inputImagenManual=r.first),e.mGM(r=e.lsd())&&(n.inputGaleria=r.first)}},standalone:!1,decls:18,vars:7,consts:[["video",""],["canvas",""],["inputGaleria",""],["inputImagenEncontrado",""],["inputImagenManual",""],[3,"translucent"],["expand","block","color","medium","slot","start",3,"click"],[1,"ion-padding",3,"fullscreen"],[3,"didDismiss","didPresent","isOpen","backdropDismiss"],[4,"ngIf"],[1,"ion-padding","ion-text-center"],["href","https://world.openfoodfacts.org","target","_blank","rel","noopener noreferrer"],["color","dark"],["slot","end"],[3,"click"],["name","close-outline"],["color","dark",1,"ion-padding"],[1,"scanner-container"],["autoplay","","playsinline","","muted","","webkit-playsinline","","x5-playsinline",""],[1,"scanner-frame"],["hidden",""],["expand","block","color","danger",1,"ion-margin-top",3,"click"],["expand","block","color","primary","size","large",3,"click"],["name","barcode-outline","slot","start"],["expand","block","color","secondary",1,"ion-margin-top",3,"click"],["name","images-outline","slot","start"],["type","file","hidden","","accept","image/*",3,"change"],[1,"separator"],["placeholder","C\xf3digo de barras","type","text","inputmode","numeric","maxlength","13",3,"ngModelChange","ngModel"],["fill","clear","slot","end",3,"click"],["name","close-circle-outline"],["expand","block","color","primary",1,"ion-margin-top",3,"click","disabled"],["expand","block","color","medium",1,"ion-margin-top",3,"click"],["color","danger",4,"ngIf"],["class","ion-text-center ion-margin-top",4,"ngIf"],["color","danger"],[1,"ion-text-center"],[1,"ion-text-center","ion-margin-top"],["position","floating"],["type","number",3,"ngModelChange","ngModel"],["fill","outline",3,"click"],["name","image-outline"],["class","ion-text-center ion-padding-top",4,"ngIf"],["expand","block","color","success",1,"ion-margin-top",3,"click"],[1,"ion-text-center","ion-padding-top"],[1,"preview-image",3,"src"],["fill","clear","color","danger","size","small",3,"click"],["inputmode","numeric","maxlength","13",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"ngModelChange","ionInput","ngModel"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"ion-header",5)(1,"ion-toolbar")(2,"ion-button",6),e.bIt("click",function(){return n.volver()}),e.EFF(3," Atr\xe1s "),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Agregar producto"),e.k0s()()(),e.j41(6,"ion-content",7)(7,"ion-modal",8),e.bIt("didDismiss",function(){return n.cerrarScannerPWA()})("didPresent",function(){return n.iniciarScannerCuandoModalEsteListo()}),e.DNE(8,R,16,0,"ng-template"),e.k0s(),e.DNE(9,B,28,4,"ion-card",9)(10,O,31,4,"ion-card",9)(11,D,39,7,"ion-card",9),e.k0s(),e.j41(12,"ion-footer",10)(13,"p"),e.EFF(14," Los datos de productos se obtienen de "),e.j41(15,"a",11),e.EFF(16," OpenFoodFacts "),e.k0s(),e.EFF(17,". "),e.k0s()()),2&o&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("isOpen",n.scannerAbierto)("backdropDismiss",!1),e.R7$(2),e.Y8G("ngIf",!n.mostrarIngresoManual&&!n.productoEncontrado),e.R7$(),e.Y8G("ngIf",n.productoEncontrado&&!n.mostrarIngresoManual),e.R7$(),e.Y8G("ngIf",n.mostrarIngresoManual))},dependencies:[f.Sq,f.bT,h.BC,h.tU,h.vS,c.Jm,c.QW,c.b_,c.I9,c.ME,c.HW,c.tN,c.W9,c.M0,c.eU,c.iq,c.$w,c.uz,c.he,c.nf,c.IO,c.BC,c.ai,c.Sb,c.su,c.Gw],styles:['ion-modal[_ngcontent-%COMP%]{--background: #000000}ion-modal[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #000000}.scanner-container[_ngcontent-%COMP%]{position:relative;width:100%;height:380px;background:#000;overflow:visible;border-radius:12px;display:block;isolation:isolate;transform:translateZ(0);-webkit-transform:translate3d(0,0,0)}.scanner-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:relative;display:block;width:100%;height:100%;object-fit:cover;background:#000;z-index:1;transform:translateZ(0);-webkit-transform:translate3d(0,0,0);backface-visibility:hidden;-webkit-backface-visibility:hidden;visibility:visible!important;opacity:1!important}.scanner-frame[_ngcontent-%COMP%]{position:absolute;border:3px solid rgba(255,255,255,.9);width:70%;height:150px;top:50%;left:50%;transform:translate(-50%,-50%);border-radius:10px;box-shadow:0 0 0 9999px #00000080;z-index:10;pointer-events:none}.separator[_ngcontent-%COMP%]{text-align:center;margin:18px 0;position:relative}.separator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:var(--ion-color-light);padding:0 12px;color:var(--ion-color-medium);font-size:.9rem;position:relative;z-index:1}.separator[_ngcontent-%COMP%]:before, .separator[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;width:40%;height:1px;background:var(--ion-color-medium)}.separator[_ngcontent-%COMP%]:before{left:0}.separator[_ngcontent-%COMP%]:after{right:0}.preview-image[_ngcontent-%COMP%]{max-width:150px;max-height:150px;border-radius:8px;object-fit:contain;border:1px solid var(--ion-color-light-shade)}@media (max-width: 576px){.scanner-container[_ngcontent-%COMP%]{height:300px}.scanner-frame[_ngcontent-%COMP%]{width:80%;height:120px}}ion-card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{border-bottom:1px solid var(--ion-color-light-shade)}ion-list[_ngcontent-%COMP%]{margin-top:8px;border-radius:8px;border:1px solid var(--ion-color-light-shade);max-height:200px;overflow-y:auto}']}),l})()}];let L=(()=>{var a;class l{}return(a=l).\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[j.iI.forChild(S),j.iI]}),l})(),U=(()=>{var a;class l{}return(a=l).\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[f.MD,h.YN,c.bv,L]}),l})()}}]);