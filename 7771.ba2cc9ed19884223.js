"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7771],{7771:($,g,d)=>{d.r(g),d.d(g,{PedidosPageModule:()=>R});var c=d(2881),P=d(4341),a=d(3092),u=d(5207),e=d(1360),p=d(9280),f=d(5032);function h(i,s){if(1&i&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&i){const n=s.$implicit;e.R7$(),e.E5c(" ",n.nombre," x",n.cantidad," - $",n.precio," ")}}function m(i,s){if(1&i&&(e.j41(0,"ion-item")(1,"ion-label")(2,"h2"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s(),e.j41(10,"p"),e.EFF(11),e.k0s(),e.j41(12,"h3"),e.EFF(13,"Productos:"),e.k0s(),e.j41(14,"ul"),e.DNE(15,h,2,3,"li",13),e.k0s()()()),2&i){const n=s.$implicit,o=e.XpG(2);e.R7$(3),e.SpI("Pedido ID: ",n._id,""),e.R7$(2),e.SpI("Fecha: ",o.formatearFecha(n.fecha),""),e.R7$(2),e.SpI("M\xe9todo de pago: ",n.metodoPago,""),e.R7$(2),e.SpI("Direcci\xf3n: ",n.direccion,""),e.R7$(2),e.SpI("Total: $",o.getTotalPedido(n),""),e.R7$(4),e.Y8G("ngForOf",n.productos)}}function _(i,s){if(1&i&&(e.j41(0,"ion-list"),e.DNE(1,m,16,6,"ion-item",13),e.k0s()),2&i){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.pedidosPaginados)}}function F(i,s){1&i&&(e.j41(0,"ion-text",14),e.EFF(1," No hay pedidos para mostrar. "),e.k0s())}function j(i,s){1&i&&e.nrm(0,"ion-loading",15)}function v(i,s){if(1&i&&(e.j41(0,"ion-text",16),e.EFF(1),e.k0s()),2&i){const n=e.XpG();e.R7$(),e.JRh(n.error)}}const k=[{path:"",component:(()=>{var i;class s{constructor(o,t){this.pedidosService=o,this.navCtrl=t,this.pedidos=[],this.pedidosPaginados=[],this.paginaActual=1,this.elementosPorPagina=8,this.totalPaginas=0,this.cargando=!1,this.error=null}ngOnInit(){this.cargarPedidos()}cargarPedidos(){if(this.cargando=!0,this.error=null,!localStorage.getItem("token"))return this.error="No hay sesi\xf3n activa. Por favor, inicia sesi\xf3n.",void(this.cargando=!1);this.pedidosService.getMisPedidos().subscribe({next:t=>{this.pedidos=t.sort((r,l)=>new Date(l.fecha).getTime()-new Date(r.fecha).getTime()),this.totalPaginas=Math.ceil(this.pedidos.length/this.elementosPorPagina),this.paginaActual=1,this.actualizarPedidosPaginados(),this.cargando=!1,0===t.length&&(this.error="No tienes pedidos asignados a\xfan.")},error:t=>{this.error=401===t.status?"Sesi\xf3n expirada. Por favor, inicia sesi\xf3n nuevamente.":403===t.status?"No tienes permisos para ver estos pedidos.":0===t.status?"No se puede conectar al servidor.":"No se pudieron cargar los pedidos.",this.cargando=!1}})}actualizarPedidosPaginados(){const o=(this.paginaActual-1)*this.elementosPorPagina;this.pedidosPaginados=this.pedidos.slice(o,o+this.elementosPorPagina)}irAPagina(o){o>=1&&o<=this.totalPaginas&&(this.paginaActual=o,this.actualizarPedidosPaginados())}volver(){this.navCtrl.navigateBack("/inventario")}refrescar(o){this.cargarPedidos(),o&&o.target.complete()}getTotalPedido(o){return o.totalConComision}formatearFecha(o){return new Date(o).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}obtenerArrayPaginas(){return Array.from({length:this.totalPaginas},(o,t)=>t+1)}}return(i=s).\u0275fac=function(o){return new(o||i)(e.rXU(p.Q),e.rXU(f.q9))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-pedidos"]],standalone:!1,decls:27,vars:9,consts:[["sinPedidos",""],[3,"translucent"],["expand","block","color","medium","slot","start",3,"click"],[2,"padding-bottom","90px"],["slot","fixed",3,"ionRefresh"],[4,"ngIf","ngIfElse"],["message","Cargando pedidos...",4,"ngIf"],["color","danger","class","ion-padding",4,"ngIf"],[1,"ion-padding"],[1,"ion-justify-content-center","ion-align-items-center"],["size","auto"],["fill","outline",3,"click","disabled"],["size","auto",1,"ion-text-center"],[4,"ngFor","ngForOf"],["color","medium",1,"ion-padding"],["message","Cargando pedidos..."],["color","danger",1,"ion-padding"]],template:function(o,t){if(1&o){const r=e.RV6();e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-button",2),e.bIt("click",function(){return e.eBV(r),e.Njj(t.volver())}),e.EFF(3," Atr\xe1s "),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Pedidos"),e.k0s()()(),e.j41(6,"ion-content",3)(7,"ion-refresher",4),e.bIt("ionRefresh",function(I){return e.eBV(r),e.Njj(t.refrescar(I))}),e.nrm(8,"ion-refresher-content"),e.k0s(),e.DNE(9,_,2,1,"ion-list",5)(10,F,2,0,"ng-template",null,0,e.C5r)(12,j,1,0,"ion-loading",6)(13,v,2,1,"ion-text",7),e.k0s(),e.j41(14,"ion-footer")(15,"ion-toolbar")(16,"ion-grid",8)(17,"ion-row",9)(18,"ion-col",10)(19,"ion-button",11),e.bIt("click",function(){return e.eBV(r),e.Njj(t.irAPagina(t.paginaActual-1))}),e.EFF(20," \xab Anterior "),e.k0s()(),e.j41(21,"ion-col",12)(22,"ion-text"),e.EFF(23),e.k0s()(),e.j41(24,"ion-col",10)(25,"ion-button",11),e.bIt("click",function(){return e.eBV(r),e.Njj(t.irAPagina(t.paginaActual+1))}),e.EFF(26," Siguiente \xbb "),e.k0s()()()()()()}if(2&o){const r=e.sdS(11);e.Y8G("translucent",!0),e.R7$(9),e.Y8G("ngIf",t.pedidosPaginados.length>0)("ngIfElse",r),e.R7$(3),e.Y8G("ngIf",t.cargando),e.R7$(),e.Y8G("ngIf",t.error),e.R7$(6),e.Y8G("disabled",1===t.paginaActual),e.R7$(4),e.Lme("P\xe1gina ",t.paginaActual," de ",t.totalPaginas,""),e.R7$(2),e.Y8G("disabled",t.paginaActual===t.totalPaginas)}},dependencies:[c.Sq,c.bT,a.Jm,a.hU,a.W9,a.M0,a.lO,a.eU,a.uz,a.he,a.nf,a.rQ,a.To,a.Ki,a.ln,a.IO,a.BC,a.ai],styles:["ion-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;z-index:1000}ion-content[_ngcontent-%COMP%]{--padding-bottom: 90px !important}"]}),s})()}];let E=(()=>{var i;class s{}return(i=s).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[u.iI.forChild(k),u.iI]}),s})(),R=(()=>{var i;class s{}return(i=s).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[c.MD,P.YN,a.bv,E]}),s})()}}]);