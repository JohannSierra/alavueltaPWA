"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7506],{5125:(k,g,s)=>{s.r(g),s.d(g,{ResumenPageModule:()=>I});var d=s(2881),f=s(4341),c=s(3092),m=s(5207),t=s(1360),R=s(4412),p=s(7643),h=s(9579),v=s(5312);let P=(()=>{var e;class i{constructor(o){this.http=o,this.productosSubject=new R.t([]),this.productos$=this.productosSubject.asObservable()}cargarCarrito(){const a=(0,h.getAuth)().currentUser;if(!a)return console.warn("No hay usuario logueado"),void this.productosSubject.next([]);a.getIdToken().then(r=>{const u=new p.Lr({Authorization:`Bearer ${r}`});this.http.get(`${v.c.apiUrl}/api/carrito`,{headers:u}).subscribe({next:l=>this.productosSubject.next(l.productos||[]),error:l=>{console.error("Error cargando carrito:",l),this.productosSubject.next([])}})})}obtenerTotal(){return this.productosSubject.getValue().reduce((a,r)=>a+r.precio*r.cantidad,0)}getProductosActuales(){return this.productosSubject.getValue()}vaciarCarrito(){const a=(0,h.getAuth)().currentUser;if(!a)return console.warn("No hay usuario logueado para vaciar el carrito."),void this.productosSubject.next([]);a.getIdToken().then(r=>{const u=new p.Lr({Authorization:`Bearer ${r}`});this.http.delete(`${v.c.apiUrl}/api/carrito`,{headers:u}).subscribe({next:()=>{this.productosSubject.next([]),console.log("Carrito vaciado con \xe9xito")},error:l=>{console.error("Error al vaciar el carrito:",l)}})})}}return(e=i).\u0275fac=function(o){return new(o||e)(t.KVO(p.Qq))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),i})();var j=s(8198),S=s(5032);function F(e,i){if(1&e&&(t.j41(0,"ion-item")(1,"ion-label")(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s(),t.j41(8,"p"),t.EFF(9),t.k0s()()()),2&e){const n=i.$implicit;t.R7$(3),t.JRh(n.nombre),t.R7$(2),t.SpI("Cantidad: ",n.cantidad,""),t.R7$(2),t.SpI("Precio unitario: $",n.precio,""),t.R7$(2),t.SpI("Total: $",n.precio*n.cantidad,"")}}function b(e,i){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,F,10,4,"ion-item",6),t.k0s()),2&e){const n=t.XpG();t.R7$(),t.Y8G("ngForOf",n.productosCarrito)}}function C(e,i){1&e&&(t.j41(0,"p"),t.EFF(1,"No hay productos en tu carrito."),t.k0s())}const E=[{path:"",component:(()=>{var e;class i{constructor(o,a,r){this.carritoService=o,this.pedirService=a,this.navCtrl=r,this.productosCarrito=[],this.total=0}ngOnInit(){this.carritoService.productos$.subscribe(o=>{this.productosCarrito=o,this.total=this.carritoService.obtenerTotal(),console.log("\u{1f50d} PagoPage - Productos en PedirService:",this.pedirService.getProductos());const a=o.map(r=>({codigo:r.codigo,nombre:r.nombre,precio:r.precio,cantidad:r.cantidad,vendedor:r.vendedor}));this.pedirService.setProductos(a)}),this.carritoService.cargarCarrito()}procesarCompra(){this.navCtrl.navigateForward("pago/datos")}volver(){this.navCtrl.navigateBack("/carrito")}}return(e=i).\u0275fac=function(o){return new(o||e)(t.rXU(P),t.rXU(j.O),t.rXU(S.q9))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-resumen"]],standalone:!1,decls:19,vars:4,consts:[["vacio",""],[3,"translucent"],["expand","block","color","medium","slot","start",3,"click"],[1,"ion-padding"],[4,"ngIf","ngIfElse"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(o,a){if(1&o){const r=t.RV6();t.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-button",2),t.bIt("click",function(){return t.eBV(r),t.Njj(a.volver())}),t.EFF(3," Atr\xe1s "),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Resumen"),t.k0s()()(),t.j41(6,"ion-content",3),t.DNE(7,b,2,1,"ion-list",4),t.j41(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),t.EFF(11,"Total a pagar"),t.k0s()(),t.j41(12,"ion-card-content")(13,"h2"),t.EFF(14),t.k0s(),t.j41(15,"ion-button",5),t.bIt("click",function(){return t.eBV(r),t.Njj(a.procesarCompra())}),t.EFF(16,"Siguiente"),t.k0s()()(),t.DNE(17,C,2,0,"ng-template",null,0,t.C5r),t.k0s()}if(2&o){const r=t.sdS(18);t.Y8G("translucent",!0),t.R7$(7),t.Y8G("ngIf",a.productosCarrito.length>0)("ngIfElse",r),t.R7$(7),t.SpI("$",a.total,"")}},dependencies:[d.Sq,d.bT,c.Jm,c.b_,c.I9,c.ME,c.tN,c.W9,c.eU,c.uz,c.he,c.nf,c.BC,c.ai],encapsulation:2}),i})()}];let $=(()=>{var e;class i{}return(e=i).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[m.iI.forChild(E),m.iI]}),i})(),I=(()=>{var e;class i{}return(e=i).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[d.MD,f.YN,c.bv,$]}),i})()}}]);